#!/usr/bin/env ruby

require 'configru'
require 'cinch'
require 'cinch/plugins/basic_ctcp'

Configru.load('eleventhbot.yml') do
  option_group :irc do
    option :nick, String, 'bot11'
    option_required :server, String
    option :port, Fixnum, 6667
    option_array :channels, String
    option :prefix, String, '!'
  end
end

require 'eleventhbot/spell'

bot = Cinch::Bot.new do
  configure do |c|
    c.nick = Configru.irc.nick
    c.server = Configru.irc.server
    c.port = Configru.irc.port
    c.channels = Configru.irc.channels
    c.plugins.prefix = /^#{Regexp.escape(Configru.irc.prefix)}/ # TODO: Respond to nick

    c.plugins.plugins = [Cinch::Plugins::BasicCTCP,
                         EleventhBot::Spell]
    c.plugins.options[Cinch::Plugins::BasicCTCP][:commands] = [:version, :time, :ping]
  end

  on :message, '`meep' do |m|
    m.reply('meep')
  end
end

bot.start
